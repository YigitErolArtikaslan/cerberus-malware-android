# cerberus-malware-android kaynak kod ve kaynak kod analizi

Ubuntu 18.04 ve/veya 20.04 üzerinde kurulum gerçekleştirilebilir.
Kurulum betiği büyük ölçüde takip edilebilir ancak düzenlemelere ve kişiselleştirmelere ihtiyacı var.

Accessbility ve phishing dosyalarını kaldırdım. Malware analizi gerçekleştirmek adına daha uyumlu hali ile paylaşıyorum.

>Bash script üzerinde düzenlemeye ihtiyacınız var, tamamen öğrenme sebebi ile oluşturulmuştur. Lütfen kötüye kullanmayınız.

>A bash script,  a long time of work, but more problems that need to be fixed. It is a work done purely for the purpose of learning. Please do not use it for other purposes !

# Kurulum & Konfigüre
> PHP kodu nginx arkasında çalışır ve http üzerinden hizmet verir. İstemci ve sunucu http üzerinden iletişim kurar.
```
https://github.com/dgoulet/torsocks
```

 
> Kurulum betiği üzerinde yapılandırmalar yapmanız gerekmektedir.


```
mysql -uroot — password=”$password” -e “CREATE USER ‘non-root’@’localhost’ IDENTIFIED BY ‘$password’;”
```
```
mysql -uroot — password=”$password” -e “GRANT ALL PRIVILEGES ON *.* TO ‘non-root’@’localhost’;”
```


# Kaynak kod incelemesi & Göze çarpan zafiyetler

## Sensitive data leaks
 ```
public String string_80 = “EnCryptResponce: “;
public String string_81 = “CheckBotRESPONCE: “;
public String string_82 = “||youNeedMoreResources||”;
```
## RCE vulnerabilities in the panel app

```
export function try_eval(command) {
  //console.log(“Called: “ + command);
  eval(‘try {‘ + command + ‘} catch (err) { console.log(“Error: “ + err ) } ‘);
}
```

## Weak Encryption Algorithm
```
return base64_encode(bin2hex(RC4Crypt::encrypt_($key, $string)));
```
## XSS Vulnerabilities in panel
```
<tr>
  <td>
  other: <textarea type=”text” name=”other” cols=”40" rows=”5"><?php echo $userdata[‘other’]; ?></textarea>
  </td>
</tr>
<tr>
  <td>
  end_subscribe: <input type=”text” name=”end_subscribe” value=”<?php echo $userdata[‘end_subscribe’]; ?>”>
  </td>
</tr>
```

```
echo “<tr><td>”.
$data[“ID”] . “</td><td>” .
“<textarea readonly>”.$data[“privatekey”] . “</textarea></td><td>” .
$data[“contact”] . “</td><td>” .
“<textarea readonly>” . $data[“serverinfo”] . “</textarea></td><td>” .
$data[“domain”] . “</td><td>” .
```
![2](https://user-images.githubusercontent.com/101067919/156980379-dd9fc9a3-618a-4ffe-b075-31e13503298a.png)
